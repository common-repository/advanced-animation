!function(){"use strict";var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,n=(window.React,window.ReactDOM),a=e.n(n),i=window.wp.i18n,o=window.wp.components;const s="08b257fc1a47e9f55428be767272942177732e54",d=[{id:"Wro0l",usage:1},{id:"tmnBE",usage:10},{id:"diLBx",usage:1e9}],l=[{id:"1682588493003",name:"1 website",usage:2},{id:"1682588266126",name:"10 website",usage:10},{id:"1682588348293",name:"unlimited website",usage:1e9}];function c(){const[e,n]=(0,t.useState)("string"==typeof window.adminAnimationGlobal?.data?.license_key?window.adminAnimationGlobal?.data?.license_key:""),[a,c]=(0,t.useState)("string"==typeof window.adminAnimationGlobal?.data?.license_key),[r,u]=(0,t.useState)(),[m,p]=(0,t.useState)(),[w,y]=(0,t.useState)(),[f,v]=(0,t.useState)(),[h,b]=(0,t.useState)();return(0,t.createElement)("div",{class:"wrap"},(0,t.createElement)("style",null,"\n\t\t\t\t.components-notice{\n\t\t\t\t\tmargin-left:0px;\n\t\t\t\t\twidth:500px;\n\t\t\t\t}\n\t\t\t\t"),(0,t.createElement)("h1",null,"Advanced Animation"),w?(0,t.createElement)(o.Notice,{status:"error",isDismissible:!1},f):null,h?(0,t.createElement)(o.Notice,{status:"success",isDismissible:!1},"Activated successfully"):null,(0,t.createElement)("div",{style:{width:500,marginTop:16,marginBottom:16}},(0,t.createElement)(o.TextControl,{label:(0,i.__)("License Key","advanced-animation")+(a?" (Active)":""),value:e,onChange:e=>n(e),disabled:a})),a?null:(0,t.createElement)(o.Button,{variant:"primary",onClick:async()=>{u(!0),p(!0),y(!1),b(!1);try{const t=await Promise.allSettled(d.map((t=>fetch(`https://payhip.com/api/v1/license/verify?product_link=${t.id}&license_key=${e}`,{headers:{"Content-Type":"application/json","payhip-api-key":s}}).then((e=>e.json())))));if(t&&Array.isArray(t)){const n=t.findIndex(((e,t)=>{const n=e.value?.data?.enabled;if(n){const n=e.value?.data?.variant_id;let a=2,i=!1;if(n){const e=l.find((e=>e.id===n));e?.usage&&(a=e.usage),e?.name?.toLowerCase().includes("unlimited")&&(i=!0)}if(i||"diLBx"===d[t].id||d[t].usage>e.value?.data?.uses||a>e.value?.data?.uses)return!0}return!1}));if(-1!==n){const t=await fetch("https://payhip.com/api/v1/license/usage",{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","payhip-api-key":s},body:new URLSearchParams(`product_link=${d[n]?.id}&license_key=${e}`)}).then((e=>e.json()));await fetch(window.adminAnimationGlobal.baseUrl+"/wp-json/advanced-animation/v1/license",{method:"post",headers:{"Content-Type":"application/json",...window.adminAnimationGlobal.nonce&&{"X-WP-Nonce":window.adminAnimationGlobal.nonce}},body:JSON.stringify(t.data)}).then((e=>e.json())),t.data?.enabled&&t.data?.uses?(c(!0),b(!0)):(y(!0),v("Activation proses failed"))}else y(!0),v("The license key is not valid or exceeds the usage limit")}}catch(e){y(!0),v("An unknown error occurred")}u(!1),p(!1)},disabled:m,isBusy:r},(0,i.__)("Activate License","advanced-animation")))}document.addEventListener("DOMContentLoaded",(function(){a().render((0,t.createElement)(c,null),document.getElementById("advanced-animation-admin"))}))}();